{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/alirezakiatonekaboni/depression-ml-classification?scriptVersionId=277445808\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"markdown","id":"0328ec4b","metadata":{"papermill":{"duration":0.008543,"end_time":"2025-11-13T18:49:32.153897","exception":false,"start_time":"2025-11-13T18:49:32.145354","status":"completed"},"tags":[]},"source":["## Import Initial Libararies"]},{"cell_type":"code","execution_count":1,"id":"b3c9826d","metadata":{"_cell_guid":"b1076dfc-b9ad-4769-8c92-a6c4dae69d19","_uuid":"8f2839f25d086af736a60e9eeb907d3b93b6e0e5","execution":{"iopub.execute_input":"2025-11-13T18:49:32.169969Z","iopub.status.busy":"2025-11-13T18:49:32.169715Z","iopub.status.idle":"2025-11-13T18:49:38.014688Z","shell.execute_reply":"2025-11-13T18:49:38.013916Z"},"papermill":{"duration":5.854276,"end_time":"2025-11-13T18:49:38.016273","exception":false,"start_time":"2025-11-13T18:49:32.161997","status":"completed"},"tags":[]},"outputs":[],"source":["import pandas as pd\n","import numpy as np\n","from scipy import stats\n","import random\n","import warnings\n","\n","import matplotlib.pyplot as plt\n","from matplotlib.colors import LinearSegmentedColormap\n","import seaborn as sns\n","import plotly.graph_objects as go\n","import plotly.express as px\n","import squarify\n","%matplotlib inline\n","\n","from sklearn.neural_network import MLPClassifier\n","from sklearn.svm import SVC\n","from category_encoders import TargetEncoder\n","from sklearn.preprocessing import LabelEncoder\n","from sklearn.pipeline import Pipeline\n","from sklearn.impute import SimpleImputer\n","from sklearn.compose import ColumnTransformer\n","from sklearn.preprocessing import StandardScaler, OrdinalEncoder, FunctionTransformer\n","from sklearn.model_selection import train_test_split, GridSearchCV, cross_val_score\n","from sklearn.metrics import make_scorer, accuracy_score\n","from sklearn.ensemble import IsolationForest\n","from xgboost import XGBClassifier\n","from catboost import CatBoostClassifier\n","from sklearn.neural_network import MLPClassifier\n","from sklearn.linear_model import LogisticRegression\n","from sklearn.ensemble import StackingClassifier, HistGradientBoostingClassifier\n","\n","warnings.filterwarnings(\"ignore\")"]},{"cell_type":"markdown","id":"d7918cce","metadata":{"papermill":{"duration":0.007896,"end_time":"2025-11-13T18:49:38.031896","exception":false,"start_time":"2025-11-13T18:49:38.024","status":"completed"},"tags":[]},"source":["## Import Data"]},{"cell_type":"code","execution_count":2,"id":"f4272862","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:38.048554Z","iopub.status.busy":"2025-11-13T18:49:38.048211Z","iopub.status.idle":"2025-11-13T18:49:38.788077Z","shell.execute_reply":"2025-11-13T18:49:38.787404Z"},"papermill":{"duration":0.749711,"end_time":"2025-11-13T18:49:38.789405","exception":false,"start_time":"2025-11-13T18:49:38.039694","status":"completed"},"tags":[]},"outputs":[],"source":["df_train = pd.read_csv(\"/kaggle/input/playground-series-s4e11/train.csv\")\n","df_test = pd.read_csv(\"/kaggle/input/playground-series-s4e11/test.csv\")"]},{"cell_type":"markdown","id":"4c5d8f9a","metadata":{"papermill":{"duration":0.00698,"end_time":"2025-11-13T18:49:38.803922","exception":false,"start_time":"2025-11-13T18:49:38.796942","status":"completed"},"tags":[]},"source":["## General View of The Data"]},{"cell_type":"code","execution_count":3,"id":"c1b11386","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:38.81942Z","iopub.status.busy":"2025-11-13T18:49:38.819206Z","iopub.status.idle":"2025-11-13T18:49:38.847126Z","shell.execute_reply":"2025-11-13T18:49:38.846437Z"},"papermill":{"duration":0.037177,"end_time":"2025-11-13T18:49:38.84825","exception":false,"start_time":"2025-11-13T18:49:38.811073","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>Name</th>\n","      <th>Gender</th>\n","      <th>Age</th>\n","      <th>City</th>\n","      <th>Working Professional or Student</th>\n","      <th>Profession</th>\n","      <th>Academic Pressure</th>\n","      <th>Work Pressure</th>\n","      <th>CGPA</th>\n","      <th>Study Satisfaction</th>\n","      <th>Job Satisfaction</th>\n","      <th>Sleep Duration</th>\n","      <th>Dietary Habits</th>\n","      <th>Degree</th>\n","      <th>Have you ever had suicidal thoughts ?</th>\n","      <th>Work/Study Hours</th>\n","      <th>Financial Stress</th>\n","      <th>Family History of Mental Illness</th>\n","      <th>Depression</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>Aaradhya</td>\n","      <td>Female</td>\n","      <td>49.0</td>\n","      <td>Ludhiana</td>\n","      <td>Working Professional</td>\n","      <td>Chef</td>\n","      <td>NaN</td>\n","      <td>5.0</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>2.0</td>\n","      <td>More than 8 hours</td>\n","      <td>Healthy</td>\n","      <td>BHM</td>\n","      <td>No</td>\n","      <td>1.0</td>\n","      <td>2.0</td>\n","      <td>No</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>Vivan</td>\n","      <td>Male</td>\n","      <td>26.0</td>\n","      <td>Varanasi</td>\n","      <td>Working Professional</td>\n","      <td>Teacher</td>\n","      <td>NaN</td>\n","      <td>4.0</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>3.0</td>\n","      <td>Less than 5 hours</td>\n","      <td>Unhealthy</td>\n","      <td>LLB</td>\n","      <td>Yes</td>\n","      <td>7.0</td>\n","      <td>3.0</td>\n","      <td>No</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>Yuvraj</td>\n","      <td>Male</td>\n","      <td>33.0</td>\n","      <td>Visakhapatnam</td>\n","      <td>Student</td>\n","      <td>NaN</td>\n","      <td>5.0</td>\n","      <td>NaN</td>\n","      <td>8.97</td>\n","      <td>2.0</td>\n","      <td>NaN</td>\n","      <td>5-6 hours</td>\n","      <td>Healthy</td>\n","      <td>B.Pharm</td>\n","      <td>Yes</td>\n","      <td>3.0</td>\n","      <td>1.0</td>\n","      <td>No</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>3</td>\n","      <td>Yuvraj</td>\n","      <td>Male</td>\n","      <td>22.0</td>\n","      <td>Mumbai</td>\n","      <td>Working Professional</td>\n","      <td>Teacher</td>\n","      <td>NaN</td>\n","      <td>5.0</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>1.0</td>\n","      <td>Less than 5 hours</td>\n","      <td>Moderate</td>\n","      <td>BBA</td>\n","      <td>Yes</td>\n","      <td>10.0</td>\n","      <td>1.0</td>\n","      <td>Yes</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4</td>\n","      <td>Rhea</td>\n","      <td>Female</td>\n","      <td>30.0</td>\n","      <td>Kanpur</td>\n","      <td>Working Professional</td>\n","      <td>Business Analyst</td>\n","      <td>NaN</td>\n","      <td>1.0</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>1.0</td>\n","      <td>5-6 hours</td>\n","      <td>Unhealthy</td>\n","      <td>BBA</td>\n","      <td>Yes</td>\n","      <td>9.0</td>\n","      <td>4.0</td>\n","      <td>Yes</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["   id      Name  Gender   Age           City Working Professional or Student  \\\n","0   0  Aaradhya  Female  49.0       Ludhiana            Working Professional   \n","1   1     Vivan    Male  26.0       Varanasi            Working Professional   \n","2   2    Yuvraj    Male  33.0  Visakhapatnam                         Student   \n","3   3    Yuvraj    Male  22.0         Mumbai            Working Professional   \n","4   4      Rhea  Female  30.0         Kanpur            Working Professional   \n","\n","         Profession  Academic Pressure  Work Pressure  CGPA  \\\n","0              Chef                NaN            5.0   NaN   \n","1           Teacher                NaN            4.0   NaN   \n","2               NaN                5.0            NaN  8.97   \n","3           Teacher                NaN            5.0   NaN   \n","4  Business Analyst                NaN            1.0   NaN   \n","\n","   Study Satisfaction  Job Satisfaction     Sleep Duration Dietary Habits  \\\n","0                 NaN               2.0  More than 8 hours        Healthy   \n","1                 NaN               3.0  Less than 5 hours      Unhealthy   \n","2                 2.0               NaN          5-6 hours        Healthy   \n","3                 NaN               1.0  Less than 5 hours       Moderate   \n","4                 NaN               1.0          5-6 hours      Unhealthy   \n","\n","    Degree Have you ever had suicidal thoughts ?  Work/Study Hours  \\\n","0      BHM                                    No               1.0   \n","1      LLB                                   Yes               7.0   \n","2  B.Pharm                                   Yes               3.0   \n","3      BBA                                   Yes              10.0   \n","4      BBA                                   Yes               9.0   \n","\n","   Financial Stress Family History of Mental Illness  Depression  \n","0               2.0                               No           0  \n","1               3.0                               No           1  \n","2               1.0                               No           1  \n","3               1.0                              Yes           1  \n","4               4.0                              Yes           0  "]},"execution_count":3,"metadata":{},"output_type":"execute_result"}],"source":["df_train.head()"]},{"cell_type":"code","execution_count":4,"id":"28ccd909","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:38.863669Z","iopub.status.busy":"2025-11-13T18:49:38.863463Z","iopub.status.idle":"2025-11-13T18:49:38.878419Z","shell.execute_reply":"2025-11-13T18:49:38.877878Z"},"papermill":{"duration":0.023909,"end_time":"2025-11-13T18:49:38.879478","exception":false,"start_time":"2025-11-13T18:49:38.855569","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>Name</th>\n","      <th>Gender</th>\n","      <th>Age</th>\n","      <th>City</th>\n","      <th>Working Professional or Student</th>\n","      <th>Profession</th>\n","      <th>Academic Pressure</th>\n","      <th>Work Pressure</th>\n","      <th>CGPA</th>\n","      <th>Study Satisfaction</th>\n","      <th>Job Satisfaction</th>\n","      <th>Sleep Duration</th>\n","      <th>Dietary Habits</th>\n","      <th>Degree</th>\n","      <th>Have you ever had suicidal thoughts ?</th>\n","      <th>Work/Study Hours</th>\n","      <th>Financial Stress</th>\n","      <th>Family History of Mental Illness</th>\n","      <th>Depression</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>140695</th>\n","      <td>140695</td>\n","      <td>Vidya</td>\n","      <td>Female</td>\n","      <td>18.0</td>\n","      <td>Ahmedabad</td>\n","      <td>Working Professional</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>5.0</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>4.0</td>\n","      <td>5-6 hours</td>\n","      <td>Unhealthy</td>\n","      <td>Class 12</td>\n","      <td>No</td>\n","      <td>2.0</td>\n","      <td>4.0</td>\n","      <td>Yes</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>140696</th>\n","      <td>140696</td>\n","      <td>Lata</td>\n","      <td>Female</td>\n","      <td>41.0</td>\n","      <td>Hyderabad</td>\n","      <td>Working Professional</td>\n","      <td>Content Writer</td>\n","      <td>NaN</td>\n","      <td>5.0</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>4.0</td>\n","      <td>7-8 hours</td>\n","      <td>Moderate</td>\n","      <td>B.Tech</td>\n","      <td>Yes</td>\n","      <td>6.0</td>\n","      <td>5.0</td>\n","      <td>Yes</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>140697</th>\n","      <td>140697</td>\n","      <td>Aanchal</td>\n","      <td>Female</td>\n","      <td>24.0</td>\n","      <td>Kolkata</td>\n","      <td>Working Professional</td>\n","      <td>Marketing Manager</td>\n","      <td>NaN</td>\n","      <td>3.0</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>1.0</td>\n","      <td>More than 8 hours</td>\n","      <td>Moderate</td>\n","      <td>B.Com</td>\n","      <td>No</td>\n","      <td>4.0</td>\n","      <td>4.0</td>\n","      <td>No</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>140698</th>\n","      <td>140698</td>\n","      <td>Prachi</td>\n","      <td>Female</td>\n","      <td>49.0</td>\n","      <td>Srinagar</td>\n","      <td>Working Professional</td>\n","      <td>Plumber</td>\n","      <td>NaN</td>\n","      <td>5.0</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>2.0</td>\n","      <td>5-6 hours</td>\n","      <td>Moderate</td>\n","      <td>ME</td>\n","      <td>Yes</td>\n","      <td>10.0</td>\n","      <td>1.0</td>\n","      <td>No</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>140699</th>\n","      <td>140699</td>\n","      <td>Sai</td>\n","      <td>Male</td>\n","      <td>27.0</td>\n","      <td>Patna</td>\n","      <td>Student</td>\n","      <td>NaN</td>\n","      <td>4.0</td>\n","      <td>NaN</td>\n","      <td>9.24</td>\n","      <td>1.0</td>\n","      <td>NaN</td>\n","      <td>Less than 5 hours</td>\n","      <td>Healthy</td>\n","      <td>BCA</td>\n","      <td>Yes</td>\n","      <td>2.0</td>\n","      <td>3.0</td>\n","      <td>Yes</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["            id     Name  Gender   Age       City  \\\n","140695  140695    Vidya  Female  18.0  Ahmedabad   \n","140696  140696     Lata  Female  41.0  Hyderabad   \n","140697  140697  Aanchal  Female  24.0    Kolkata   \n","140698  140698   Prachi  Female  49.0   Srinagar   \n","140699  140699      Sai    Male  27.0      Patna   \n","\n","       Working Professional or Student         Profession  Academic Pressure  \\\n","140695            Working Professional                NaN                NaN   \n","140696            Working Professional     Content Writer                NaN   \n","140697            Working Professional  Marketing Manager                NaN   \n","140698            Working Professional            Plumber                NaN   \n","140699                         Student                NaN                4.0   \n","\n","        Work Pressure  CGPA  Study Satisfaction  Job Satisfaction  \\\n","140695            5.0   NaN                 NaN               4.0   \n","140696            5.0   NaN                 NaN               4.0   \n","140697            3.0   NaN                 NaN               1.0   \n","140698            5.0   NaN                 NaN               2.0   \n","140699            NaN  9.24                 1.0               NaN   \n","\n","           Sleep Duration Dietary Habits    Degree  \\\n","140695          5-6 hours      Unhealthy  Class 12   \n","140696          7-8 hours       Moderate    B.Tech   \n","140697  More than 8 hours       Moderate     B.Com   \n","140698          5-6 hours       Moderate        ME   \n","140699  Less than 5 hours        Healthy       BCA   \n","\n","       Have you ever had suicidal thoughts ?  Work/Study Hours  \\\n","140695                                    No               2.0   \n","140696                                   Yes               6.0   \n","140697                                    No               4.0   \n","140698                                   Yes              10.0   \n","140699                                   Yes               2.0   \n","\n","        Financial Stress Family History of Mental Illness  Depression  \n","140695               4.0                              Yes           1  \n","140696               5.0                              Yes           0  \n","140697               4.0                               No           0  \n","140698               1.0                               No           0  \n","140699               3.0                              Yes           1  "]},"execution_count":4,"metadata":{},"output_type":"execute_result"}],"source":["df_train.tail()"]},{"cell_type":"code","execution_count":5,"id":"790a0b8a","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:38.895496Z","iopub.status.busy":"2025-11-13T18:49:38.895295Z","iopub.status.idle":"2025-11-13T18:49:38.901397Z","shell.execute_reply":"2025-11-13T18:49:38.900701Z"},"papermill":{"duration":0.015497,"end_time":"2025-11-13T18:49:38.902501","exception":false,"start_time":"2025-11-13T18:49:38.887004","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["Index(['id', 'Name', 'Gender', 'Age', 'City',\n","       'Working Professional or Student', 'Profession', 'Academic Pressure',\n","       'Work Pressure', 'CGPA', 'Study Satisfaction', 'Job Satisfaction',\n","       'Sleep Duration', 'Dietary Habits', 'Degree',\n","       'Have you ever had suicidal thoughts ?', 'Work/Study Hours',\n","       'Financial Stress', 'Family History of Mental Illness', 'Depression'],\n","      dtype='object')"]},"execution_count":5,"metadata":{},"output_type":"execute_result"}],"source":["df_train.columns"]},{"cell_type":"code","execution_count":6,"id":"0637e6b5","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:38.9185Z","iopub.status.busy":"2025-11-13T18:49:38.918308Z","iopub.status.idle":"2025-11-13T18:49:38.998225Z","shell.execute_reply":"2025-11-13T18:49:38.99756Z"},"papermill":{"duration":0.089161,"end_time":"2025-11-13T18:49:38.999323","exception":false,"start_time":"2025-11-13T18:49:38.910162","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>Age</th>\n","      <th>Academic Pressure</th>\n","      <th>Work Pressure</th>\n","      <th>CGPA</th>\n","      <th>Study Satisfaction</th>\n","      <th>Job Satisfaction</th>\n","      <th>Work/Study Hours</th>\n","      <th>Financial Stress</th>\n","      <th>Depression</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>count</th>\n","      <td>140700.000000</td>\n","      <td>140700.000000</td>\n","      <td>27897.000000</td>\n","      <td>112782.000000</td>\n","      <td>27898.000000</td>\n","      <td>27897.000000</td>\n","      <td>112790.000000</td>\n","      <td>140700.000000</td>\n","      <td>140696.000000</td>\n","      <td>140700.000000</td>\n","    </tr>\n","    <tr>\n","      <th>mean</th>\n","      <td>70349.500000</td>\n","      <td>40.388621</td>\n","      <td>3.142273</td>\n","      <td>2.998998</td>\n","      <td>7.658636</td>\n","      <td>2.944940</td>\n","      <td>2.974404</td>\n","      <td>6.252679</td>\n","      <td>2.988983</td>\n","      <td>0.181713</td>\n","    </tr>\n","    <tr>\n","      <th>std</th>\n","      <td>40616.735775</td>\n","      <td>12.384099</td>\n","      <td>1.380457</td>\n","      <td>1.405771</td>\n","      <td>1.464466</td>\n","      <td>1.360197</td>\n","      <td>1.416078</td>\n","      <td>3.853615</td>\n","      <td>1.413633</td>\n","      <td>0.385609</td>\n","    </tr>\n","    <tr>\n","      <th>min</th>\n","      <td>0.000000</td>\n","      <td>18.000000</td>\n","      <td>1.000000</td>\n","      <td>1.000000</td>\n","      <td>5.030000</td>\n","      <td>1.000000</td>\n","      <td>1.000000</td>\n","      <td>0.000000</td>\n","      <td>1.000000</td>\n","      <td>0.000000</td>\n","    </tr>\n","    <tr>\n","      <th>25%</th>\n","      <td>35174.750000</td>\n","      <td>29.000000</td>\n","      <td>2.000000</td>\n","      <td>2.000000</td>\n","      <td>6.290000</td>\n","      <td>2.000000</td>\n","      <td>2.000000</td>\n","      <td>3.000000</td>\n","      <td>2.000000</td>\n","      <td>0.000000</td>\n","    </tr>\n","    <tr>\n","      <th>50%</th>\n","      <td>70349.500000</td>\n","      <td>42.000000</td>\n","      <td>3.000000</td>\n","      <td>3.000000</td>\n","      <td>7.770000</td>\n","      <td>3.000000</td>\n","      <td>3.000000</td>\n","      <td>6.000000</td>\n","      <td>3.000000</td>\n","      <td>0.000000</td>\n","    </tr>\n","    <tr>\n","      <th>75%</th>\n","      <td>105524.250000</td>\n","      <td>51.000000</td>\n","      <td>4.000000</td>\n","      <td>4.000000</td>\n","      <td>8.920000</td>\n","      <td>4.000000</td>\n","      <td>4.000000</td>\n","      <td>10.000000</td>\n","      <td>4.000000</td>\n","      <td>0.000000</td>\n","    </tr>\n","    <tr>\n","      <th>max</th>\n","      <td>140699.000000</td>\n","      <td>60.000000</td>\n","      <td>5.000000</td>\n","      <td>5.000000</td>\n","      <td>10.000000</td>\n","      <td>5.000000</td>\n","      <td>5.000000</td>\n","      <td>12.000000</td>\n","      <td>5.000000</td>\n","      <td>1.000000</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["                  id            Age  Academic Pressure  Work Pressure  \\\n","count  140700.000000  140700.000000       27897.000000  112782.000000   \n","mean    70349.500000      40.388621           3.142273       2.998998   \n","std     40616.735775      12.384099           1.380457       1.405771   \n","min         0.000000      18.000000           1.000000       1.000000   \n","25%     35174.750000      29.000000           2.000000       2.000000   \n","50%     70349.500000      42.000000           3.000000       3.000000   \n","75%    105524.250000      51.000000           4.000000       4.000000   \n","max    140699.000000      60.000000           5.000000       5.000000   \n","\n","               CGPA  Study Satisfaction  Job Satisfaction  Work/Study Hours  \\\n","count  27898.000000        27897.000000     112790.000000     140700.000000   \n","mean       7.658636            2.944940          2.974404          6.252679   \n","std        1.464466            1.360197          1.416078          3.853615   \n","min        5.030000            1.000000          1.000000          0.000000   \n","25%        6.290000            2.000000          2.000000          3.000000   \n","50%        7.770000            3.000000          3.000000          6.000000   \n","75%        8.920000            4.000000          4.000000         10.000000   \n","max       10.000000            5.000000          5.000000         12.000000   \n","\n","       Financial Stress     Depression  \n","count     140696.000000  140700.000000  \n","mean           2.988983       0.181713  \n","std            1.413633       0.385609  \n","min            1.000000       0.000000  \n","25%            2.000000       0.000000  \n","50%            3.000000       0.000000  \n","75%            4.000000       0.000000  \n","max            5.000000       1.000000  "]},"execution_count":6,"metadata":{},"output_type":"execute_result"}],"source":["df_train.describe()"]},{"cell_type":"code","execution_count":7,"id":"d876b74b","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:39.016684Z","iopub.status.busy":"2025-11-13T18:49:39.016175Z","iopub.status.idle":"2025-11-13T18:49:39.095403Z","shell.execute_reply":"2025-11-13T18:49:39.09472Z"},"papermill":{"duration":0.088936,"end_time":"2025-11-13T18:49:39.096427","exception":false,"start_time":"2025-11-13T18:49:39.007491","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 140700 entries, 0 to 140699\n","Data columns (total 20 columns):\n"," #   Column                                 Non-Null Count   Dtype  \n","---  ------                                 --------------   -----  \n"," 0   id                                     140700 non-null  int64  \n"," 1   Name                                   140700 non-null  object \n"," 2   Gender                                 140700 non-null  object \n"," 3   Age                                    140700 non-null  float64\n"," 4   City                                   140700 non-null  object \n"," 5   Working Professional or Student        140700 non-null  object \n"," 6   Profession                             104070 non-null  object \n"," 7   Academic Pressure                      27897 non-null   float64\n"," 8   Work Pressure                          112782 non-null  float64\n"," 9   CGPA                                   27898 non-null   float64\n"," 10  Study Satisfaction                     27897 non-null   float64\n"," 11  Job Satisfaction                       112790 non-null  float64\n"," 12  Sleep Duration                         140700 non-null  object \n"," 13  Dietary Habits                         140696 non-null  object \n"," 14  Degree                                 140698 non-null  object \n"," 15  Have you ever had suicidal thoughts ?  140700 non-null  object \n"," 16  Work/Study Hours                       140700 non-null  float64\n"," 17  Financial Stress                       140696 non-null  float64\n"," 18  Family History of Mental Illness       140700 non-null  object \n"," 19  Depression                             140700 non-null  int64  \n","dtypes: float64(8), int64(2), object(10)\n","memory usage: 21.5+ MB\n"]}],"source":["df_train.info()"]},{"cell_type":"markdown","id":"96101306","metadata":{"papermill":{"duration":0.007795,"end_time":"2025-11-13T18:49:39.112151","exception":false,"start_time":"2025-11-13T18:49:39.104356","status":"completed"},"tags":[]},"source":["## Data Renaming"]},{"cell_type":"code","execution_count":8,"id":"3d86ad45","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:39.128611Z","iopub.status.busy":"2025-11-13T18:49:39.128381Z","iopub.status.idle":"2025-11-13T18:49:39.132546Z","shell.execute_reply":"2025-11-13T18:49:39.132007Z"},"papermill":{"duration":0.013536,"end_time":"2025-11-13T18:49:39.133516","exception":false,"start_time":"2025-11-13T18:49:39.11998","status":"completed"},"tags":[]},"outputs":[],"source":["rename_dict = {\n","    \"Working Professional or Student\": \"Employment\",\n","    \"Have you ever had suicidal thoughts ?\": \"Suicidal thoughts\",\n","    \"Work/Study Hours\": \"WS hours\",\n","    \"Family History of Mental Illness\": \"Family illness\"\n","}\n","\n","df_train.rename(columns=rename_dict, inplace=True)\n","df_test.rename(columns=rename_dict, inplace=True)"]},{"cell_type":"markdown","id":"c4db3cf9","metadata":{"papermill":{"duration":0.007685,"end_time":"2025-11-13T18:49:39.148984","exception":false,"start_time":"2025-11-13T18:49:39.141299","status":"completed"},"tags":[]},"source":["## Data Unification"]},{"cell_type":"code","execution_count":9,"id":"99685c14","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:39.165458Z","iopub.status.busy":"2025-11-13T18:49:39.165269Z","iopub.status.idle":"2025-11-13T18:49:41.333999Z","shell.execute_reply":"2025-11-13T18:49:41.333163Z"},"papermill":{"duration":2.179089,"end_time":"2025-11-13T18:49:41.335817","exception":false,"start_time":"2025-11-13T18:49:39.156728","status":"completed"},"tags":[]},"outputs":[],"source":["columns = [\"Sleep Duration\", \"Dietary Habits\", \"Gender\", \"Employment\", \"Suicidal thoughts\", \"Depression\", \"Family illness\"]\n","\n","for df in [df_train, df_test]:\n","    if 'Name' in df.columns:\n","        df.drop([\"Name\"], axis=1, inplace=True)\n","    \n","    for col in columns:\n","        if col in df.columns:\n","            df[col] = df[col].astype(str).str.strip().str.lower()\n","\n","columns_to_clean = ['City', 'Profession', 'Sleep Duration', 'Dietary Habits', 'Degree']\n","\n","for col in columns_to_clean:\n","    value_counts = df_train[col].value_counts()\n","    rare_values = value_counts[value_counts < 13].index\n","\n","    for df in [df_train, df_test]:\n","        df[col] = df[col].apply(lambda x: np.nan if x in rare_values else x)"]},{"cell_type":"markdown","id":"9a567a91","metadata":{"papermill":{"duration":0.007934,"end_time":"2025-11-13T18:49:41.351972","exception":false,"start_time":"2025-11-13T18:49:41.344038","status":"completed"},"tags":[]},"source":["## Data Type Transformation"]},{"cell_type":"code","execution_count":10,"id":"a14ce885","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:41.369235Z","iopub.status.busy":"2025-11-13T18:49:41.368998Z","iopub.status.idle":"2025-11-13T18:49:41.623008Z","shell.execute_reply":"2025-11-13T18:49:41.622309Z"},"papermill":{"duration":0.264504,"end_time":"2025-11-13T18:49:41.624465","exception":false,"start_time":"2025-11-13T18:49:41.359961","status":"completed"},"tags":[]},"outputs":[],"source":["for df in [df_train, df_test]:\n","    num_cols = df.select_dtypes(include=['int64', 'int32', 'float64']).columns\n","\n","    for col in num_cols:\n","        if col not in [\"CGPA\", \"id\"]:\n","            col_min = df[col].min()\n","            col_max = df[col].max()\n","\n","            if -32768 <= col_min and col_max <= 32767:\n","                if df[col].dtype == 'float64':\n","                    df[col] = df[col].round().astype(\"Int16\")\n","                else:\n","                    df[col] = df[col].astype(\"Int16\")"]},{"cell_type":"markdown","id":"2c907613","metadata":{"papermill":{"duration":0.008021,"end_time":"2025-11-13T18:49:41.640851","exception":false,"start_time":"2025-11-13T18:49:41.63283","status":"completed"},"tags":[]},"source":["## Descretization"]},{"cell_type":"code","execution_count":11,"id":"4c3297ea","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:41.658484Z","iopub.status.busy":"2025-11-13T18:49:41.65827Z","iopub.status.idle":"2025-11-13T18:49:41.976845Z","shell.execute_reply":"2025-11-13T18:49:41.976231Z"},"papermill":{"duration":0.329586,"end_time":"2025-11-13T18:49:41.978261","exception":false,"start_time":"2025-11-13T18:49:41.648675","status":"completed"},"tags":[]},"outputs":[],"source":["sleep_map = {\n","    \"7-8 hours\": 1,\n","    \"more than 8 hours\": 2,\n","    \"5-6 hours\": 3,\n","    \"less than 5 hours\": 4\n","}\n","\n","diet_map = {\n","    \"healthy\": 1,\n","    \"moderate\": 2,\n","    \"unhealthy\": 3\n","}\n","\n","gender_map = {\"male\": 0, \"female\": 1}\n","employment_map = {\"working professional\": 1, \"student\": 0}\n","yes_no_map = {\"no\": 0, \"yes\": 1}\n","\n","WS_hours = {\n","    0: 1,\n","    1: 2, 2: 2, 3: 2, 4: 3, 5: 3, 6: 3, \n","    7: 4, 8: 4, 9: 4, 10: 5, 11: 5, 12: 5\n","}\n","\n","education_levels = {\n","    \"Class 12\": 1,\n","    \"BA\": 2, \"BSc\": 2, \"B.Com\": 2, \"B.Ed\": 2, \"BCA\": 2, \"B.Arch\": 2, \n","    \"BBA\": 2, \"BHM\": 2, \"B.Pharm\": 2, \"BE\": 2, \"B.Tech\": 2,\n","    \"MA\": 3, \"MSc\": 3, \"M.Com\": 3, \"M.Ed\": 3, \"MCA\": 3,\n","    \"M.Tech\": 3, \"MBA\": 3, \"M.Pharm\": 3, \"ME\": 3, \"MHM\": 3,\n","    \"MD\": 4, \"LLB\": 4, \"LLM\": 4, \"MBBS\": 4, \"PhD\": 4\n","}\n","\n","for df in [df_train, df_test]:\n","    if \"Sleep Duration\" in df.columns:\n","        df[\"Sleep Duration\"] = df[\"Sleep Duration\"].map(sleep_map).astype(\"Int16\")\n","    \n","    if \"Dietary Habits\" in df.columns:\n","        df[\"Dietary Habits\"] = df[\"Dietary Habits\"].map(diet_map).astype(\"Int16\")\n","    \n","    if \"Gender\" in df.columns:\n","        df[\"Gender\"] = df[\"Gender\"].map(gender_map)\n","    \n","    if \"Employment\" in df.columns:\n","        df[\"Employment\"] = df[\"Employment\"].map(employment_map)\n","    \n","    if \"Suicidal thoughts\" in df.columns:\n","        df[\"Suicidal thoughts\"] = df[\"Suicidal thoughts\"].map(yes_no_map)\n","    \n","    if \"Family illness\" in df.columns:\n","        df[\"Family illness\"] = df[\"Family illness\"].map(yes_no_map)\n","\n","\n","for df in [df_train, df_test]:\n","    if \"Degree\" in df.columns:\n","        df[\"Degree\"] = df[\"Degree\"].map(education_levels).astype(\"Int16\")\n","\n","def assign_class(grade):\n","    if grade == 0:\n","        return 0\n","    elif 5.00 <= grade <= 5.99:\n","        return 1\n","    elif 6.00 <= grade <= 6.99:\n","        return 2\n","    elif 7.00 <= grade <= 7.99:\n","        return 3\n","    elif 8.00 <= grade <= 8.99:\n","        return 4\n","    elif 9.00 <= grade <= 10.00:\n","        return 5\n","    else:\n","        return None  \n","\n","\n","for df in [df_train, df_test]:\n","    \n","    if \"WS hours\" in df.columns:\n","        df[\"WS hours\"] = df[\"WS hours\"].map(WS_hours)\n","    \n","    if \"CGPA\" in df.columns:\n","        df[\"CGPA\"] = df[\"CGPA\"].fillna(0)\n","        df[\"CGPA\"] = df[\"CGPA\"].apply(assign_class)"]},{"cell_type":"markdown","id":"f37d9d66","metadata":{"papermill":{"duration":0.007807,"end_time":"2025-11-13T18:49:41.994156","exception":false,"start_time":"2025-11-13T18:49:41.986349","status":"completed"},"tags":[]},"source":["## Cheking Record of The Features"]},{"cell_type":"code","execution_count":12,"id":"b92327e2","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:42.011085Z","iopub.status.busy":"2025-11-13T18:49:42.010847Z","iopub.status.idle":"2025-11-13T18:49:42.028165Z","shell.execute_reply":"2025-11-13T18:49:42.027337Z"},"papermill":{"duration":0.02729,"end_time":"2025-11-13T18:49:42.029228","exception":false,"start_time":"2025-11-13T18:49:42.001938","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["Depression\n","0    115133\n","1     25567\n","Name: count, dtype: int64"]},"execution_count":12,"metadata":{},"output_type":"execute_result"}],"source":["df_train[\"Depression\"].value_counts()"]},{"cell_type":"code","execution_count":13,"id":"d761c849","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:42.045856Z","iopub.status.busy":"2025-11-13T18:49:42.045377Z","iopub.status.idle":"2025-11-13T18:49:42.060611Z","shell.execute_reply":"2025-11-13T18:49:42.060029Z"},"papermill":{"duration":0.024742,"end_time":"2025-11-13T18:49:42.061723","exception":false,"start_time":"2025-11-13T18:49:42.036981","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["Depression\n","0    0.818287\n","1    0.181713\n","Name: proportion, dtype: float64"]},"execution_count":13,"metadata":{},"output_type":"execute_result"}],"source":["df_train[\"Depression\"].value_counts(normalize = True)"]},{"cell_type":"code","execution_count":14,"id":"ca69f6a8","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:42.079225Z","iopub.status.busy":"2025-11-13T18:49:42.079035Z","iopub.status.idle":"2025-11-13T18:49:42.138742Z","shell.execute_reply":"2025-11-13T18:49:42.138068Z"},"papermill":{"duration":0.069716,"end_time":"2025-11-13T18:49:42.139975","exception":false,"start_time":"2025-11-13T18:49:42.070259","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["There are 0 duplicates in the dataset.\n"]}],"source":["print(\"There are {} duplicates in the dataset.\".format(df_train.duplicated().sum()))"]},{"cell_type":"code","execution_count":15,"id":"6d1ec830","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:42.157662Z","iopub.status.busy":"2025-11-13T18:49:42.157424Z","iopub.status.idle":"2025-11-13T18:49:42.182957Z","shell.execute_reply":"2025-11-13T18:49:42.182264Z"},"papermill":{"duration":0.035746,"end_time":"2025-11-13T18:49:42.184326","exception":false,"start_time":"2025-11-13T18:49:42.14858","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Checking for missing values in each column:\n","id                         0\n","Gender                     0\n","Age                        0\n","City                      98\n","Employment                 0\n","Profession             36680\n","Academic Pressure     112803\n","Work Pressure          27918\n","CGPA                       0\n","Study Satisfaction    112803\n","Job Satisfaction       27910\n","Sleep Duration            79\n","Dietary Habits            27\n","Degree                   116\n","Suicidal thoughts          0\n","WS hours                   0\n","Financial Stress           4\n","Family illness             0\n","Depression                 0\n","dtype: int64\n"]}],"source":["print(\"Checking for missing values in each column:\")\n","print(df_train.isnull().sum())"]},{"cell_type":"code","execution_count":16,"id":"4ec5ced3","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:42.203247Z","iopub.status.busy":"2025-11-13T18:49:42.202568Z","iopub.status.idle":"2025-11-13T18:49:42.231647Z","shell.execute_reply":"2025-11-13T18:49:42.230896Z"},"papermill":{"duration":0.039517,"end_time":"2025-11-13T18:49:42.233088","exception":false,"start_time":"2025-11-13T18:49:42.193571","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Target Column: Depression\n","\n","Categorical Columns: ['City', 'Profession', 'Depression']\n","\n","Numerical Columns: ['Gender', 'Age', 'Employment', 'Academic Pressure', 'Work Pressure', 'CGPA', 'Study Satisfaction', 'Job Satisfaction', 'Sleep Duration', 'Dietary Habits', 'Degree', 'Suicidal thoughts', 'WS hours', 'Financial Stress', 'Family illness']\n"]}],"source":["test_ids = df_test['id']\n","\n","df_train = df_train.drop(['id'], axis=1)\n","df_test = df_test.drop(['id'], axis=1)\n","\n","target_column = 'Depression'\n","\n","categorical_columns = df_train.select_dtypes(include=['object']).columns\n","numerical_columns = df_train.select_dtypes(exclude=['object']).columns\n","\n","print(\"Target Column:\", target_column)\n","print(\"\\nCategorical Columns:\", categorical_columns.tolist())\n","print(\"\\nNumerical Columns:\", numerical_columns.tolist())"]},{"cell_type":"code","execution_count":17,"id":"3f8b71d8","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:42.251691Z","iopub.status.busy":"2025-11-13T18:49:42.251464Z","iopub.status.idle":"2025-11-13T18:49:42.288243Z","shell.execute_reply":"2025-11-13T18:49:42.28741Z"},"papermill":{"duration":0.046917,"end_time":"2025-11-13T18:49:42.289298","exception":false,"start_time":"2025-11-13T18:49:42.242381","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Columns: Gender\n","[1 0]\n","---------------------------------\n","Columns: Age\n","<IntegerArray>\n","[49, 26, 33, 22, 30, 59, 47, 38, 24, 42, 55, 51, 39, 29, 50, 23, 56, 45, 37,\n"," 46, 31, 19, 28, 25, 41, 60, 18, 36, 21, 58, 44, 43, 40, 35, 54, 27, 52, 48,\n"," 57, 53, 34, 20, 32]\n","Length: 43, dtype: Int16\n","---------------------------------\n","Columns: City\n","['Ludhiana' 'Varanasi' 'Visakhapatnam' 'Mumbai' 'Kanpur' 'Ahmedabad'\n"," 'Thane' 'Nashik' 'Bangalore' 'Patna' 'Rajkot' 'Jaipur' 'Pune' 'Lucknow'\n"," 'Meerut' 'Agra' 'Surat' 'Faridabad' 'Hyderabad' 'Srinagar' 'Ghaziabad'\n"," 'Kolkata' 'Chennai' 'Kalyan' 'Nagpur' 'Vadodara' 'Vasai-Virar' 'Delhi'\n"," 'Bhopal' 'Indore' nan]\n","---------------------------------\n","Columns: Employment\n","[1 0]\n","---------------------------------\n","Columns: Profession\n","['Chef' 'Teacher' nan 'Business Analyst' 'Finanancial Analyst' 'Chemist'\n"," 'Electrician' 'Software Engineer' 'Data Scientist' 'Plumber'\n"," 'Marketing Manager' 'Accountant' 'Entrepreneur' 'HR Manager'\n"," 'UX/UI Designer' 'Content Writer' 'Educational Consultant'\n"," 'Civil Engineer' 'Manager' 'Pharmacist' 'Financial Analyst' 'Architect'\n"," 'Mechanical Engineer' 'Customer Support' 'Consultant' 'Judge'\n"," 'Researcher' 'Pilot' 'Graphic Designer' 'Travel Consultant'\n"," 'Digital Marketer' 'Lawyer' 'Research Analyst' 'Sales Executive' 'Doctor'\n"," 'Investment Banker']\n","---------------------------------\n","Columns: Academic Pressure\n","<IntegerArray>\n","[<NA>, 5, 2, 3, 4, 1]\n","Length: 6, dtype: Int16\n","---------------------------------\n","Columns: Work Pressure\n","<IntegerArray>\n","[5, 4, <NA>, 1, 2, 3]\n","Length: 6, dtype: Int16\n","---------------------------------\n","Columns: CGPA\n","[0 4 1 3 5 2]\n","---------------------------------\n","Columns: Study Satisfaction\n","<IntegerArray>\n","[<NA>, 2, 5, 3, 4, 1]\n","Length: 6, dtype: Int16\n","---------------------------------\n","Columns: Job Satisfaction\n","<IntegerArray>\n","[2, 3, <NA>, 1, 5, 4]\n","Length: 6, dtype: Int16\n","---------------------------------\n","Columns: Sleep Duration\n","<IntegerArray>\n","[2, 4, 3, 1, <NA>]\n","Length: 5, dtype: Int16\n","---------------------------------\n","Columns: Dietary Habits\n","<IntegerArray>\n","[1, 3, 2, <NA>]\n","Length: 4, dtype: Int16\n","---------------------------------\n","Columns: Degree\n","<IntegerArray>\n","[2, 4, 3, 1, <NA>]\n","Length: 5, dtype: Int16\n","---------------------------------\n","Columns: Suicidal thoughts\n","[0 1]\n","---------------------------------\n","Columns: WS hours\n","[2 4 5 3 1]\n","---------------------------------\n","Columns: Financial Stress\n","<IntegerArray>\n","[2, 3, 1, 4, 5, <NA>]\n","Length: 6, dtype: Int16\n","---------------------------------\n","Columns: Family illness\n","[0 1]\n","---------------------------------\n","Columns: Depression\n","['0' '1']\n","---------------------------------\n"]}],"source":["for col in df_train.columns:\n","    print(f\"Columns: {col}\")\n","    print(df_train[col].unique())\n","    print(\"-\" * 33) "]},{"cell_type":"code","execution_count":18,"id":"613d5a09","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:42.306965Z","iopub.status.busy":"2025-11-13T18:49:42.306697Z","iopub.status.idle":"2025-11-13T18:49:42.337959Z","shell.execute_reply":"2025-11-13T18:49:42.337099Z"},"papermill":{"duration":0.041297,"end_time":"2025-11-13T18:49:42.339128","exception":false,"start_time":"2025-11-13T18:49:42.297831","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["\n","Value counts in 'City':\n","City\n","Kalyan           6591\n","Patna            5924\n","Vasai-Virar      5765\n","Kolkata          5689\n","Ahmedabad        5613\n","Meerut           5528\n","Ludhiana         5226\n","Pune             5210\n","Rajkot           5207\n","Visakhapatnam    5176\n","Srinagar         5074\n","Mumbai           4966\n","Indore           4872\n","Agra             4684\n","Surat            4636\n","Varanasi         4606\n","Vadodara         4568\n","Hyderabad        4496\n","Kanpur           4398\n","Jaipur           4328\n","Thane            4289\n","Lucknow          4280\n","Nagpur           4209\n","Bangalore        4123\n","Chennai          4044\n","Ghaziabad        3620\n","Delhi            3593\n","Bhopal           3475\n","Faridabad        3268\n","Nashik           3144\n","Name: count, dtype: int64\n","\n","Value counts in 'Profession':\n","Profession\n","Teacher                   24906\n","Content Writer             7814\n","Architect                  4370\n","Consultant                 4229\n","HR Manager                 4022\n","Pharmacist                 3893\n","Doctor                     3255\n","Business Analyst           3161\n","Entrepreneur               2968\n","Chemist                    2967\n","Chef                       2862\n","Educational Consultant     2852\n","Data Scientist             2390\n","Researcher                 2328\n","Lawyer                     2212\n","Customer Support           2055\n","Marketing Manager          1976\n","Pilot                      1913\n","Travel Consultant          1860\n","Plumber                    1748\n","Sales Executive            1739\n","Manager                    1737\n","Judge                      1712\n","Electrician                1582\n","Financial Analyst          1574\n","Software Engineer          1510\n","Civil Engineer             1470\n","UX/UI Designer             1452\n","Digital Marketer           1372\n","Accountant                 1339\n","Finanancial Analyst        1329\n","Mechanical Engineer        1177\n","Graphic Designer           1163\n","Research Analyst            690\n","Investment Banker           393\n","Name: count, dtype: int64\n","\n","Value counts in 'Depression':\n","Depression\n","0    115133\n","1     25567\n","Name: count, dtype: int64\n"]}],"source":["for column in categorical_columns:\n","    print(f\"\\nValue counts in '{column}':\\n{df_train[column].value_counts().head(50)}\")"]},{"cell_type":"markdown","id":"176235c9","metadata":{"papermill":{"duration":0.008265,"end_time":"2025-11-13T18:49:42.355695","exception":false,"start_time":"2025-11-13T18:49:42.34743","status":"completed"},"tags":[]},"source":["## Anomaly & Missing Handling"]},{"cell_type":"code","execution_count":19,"id":"81118302","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:42.373521Z","iopub.status.busy":"2025-11-13T18:49:42.373062Z","iopub.status.idle":"2025-11-13T18:49:42.398417Z","shell.execute_reply":"2025-11-13T18:49:42.397615Z"},"papermill":{"duration":0.035423,"end_time":"2025-11-13T18:49:42.399535","exception":false,"start_time":"2025-11-13T18:49:42.364112","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Checking for missing values in each column:\n","Gender                     0\n","Age                        0\n","City                      98\n","Employment                 0\n","Profession             36680\n","Academic Pressure     112803\n","Work Pressure          27918\n","CGPA                       0\n","Study Satisfaction    112803\n","Job Satisfaction       27910\n","Sleep Duration            79\n","Dietary Habits            27\n","Degree                   116\n","Suicidal thoughts          0\n","WS hours                   0\n","Financial Stress           4\n","Family illness             0\n","Depression                 0\n","dtype: int64\n"]}],"source":["print(\"Checking for missing values in each column:\")\n","print(df_train.isnull().sum())"]},{"cell_type":"code","execution_count":20,"id":"4f911d7a","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:42.417475Z","iopub.status.busy":"2025-11-13T18:49:42.417273Z","iopub.status.idle":"2025-11-13T18:49:42.43136Z","shell.execute_reply":"2025-11-13T18:49:42.430791Z"},"papermill":{"duration":0.024454,"end_time":"2025-11-13T18:49:42.432443","exception":false,"start_time":"2025-11-13T18:49:42.407989","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Checking for missing values in each column:\n","Gender                    0\n","Age                       0\n","City                     20\n","Employment                0\n","Profession            24656\n","Academic Pressure     75033\n","Work Pressure         18778\n","CGPA                      0\n","Study Satisfaction    75033\n","Job Satisfaction      18774\n","Sleep Duration           54\n","Dietary Habits           30\n","Degree                   86\n","Suicidal thoughts         0\n","WS hours                  0\n","Financial Stress          0\n","Family illness            0\n","dtype: int64\n"]}],"source":["print(\"Checking for missing values in each column:\")\n","print(df_test.isnull().sum())"]},{"cell_type":"code","execution_count":21,"id":"5be7fc22","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:42.450866Z","iopub.status.busy":"2025-11-13T18:49:42.45065Z","iopub.status.idle":"2025-11-13T18:49:42.463258Z","shell.execute_reply":"2025-11-13T18:49:42.462681Z"},"papermill":{"duration":0.023039,"end_time":"2025-11-13T18:49:42.464333","exception":false,"start_time":"2025-11-13T18:49:42.441294","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Number of students who have a profession: 31\n"]}],"source":["students_with_profession = df_train[(df_train[\"Employment\"] == 0) & (df_train[\"Profession\"].notna())]\n","print(\"Number of students who have a profession:\", len(students_with_profession))"]},{"cell_type":"code","execution_count":22,"id":"9b5659c1","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:42.482478Z","iopub.status.busy":"2025-11-13T18:49:42.482044Z","iopub.status.idle":"2025-11-13T18:49:42.490803Z","shell.execute_reply":"2025-11-13T18:49:42.490222Z"},"papermill":{"duration":0.018778,"end_time":"2025-11-13T18:49:42.491744","exception":false,"start_time":"2025-11-13T18:49:42.472966","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Number of students who have a profession: 24\n"]}],"source":["students_with_profession = df_test[(df_test[\"Employment\"] == 0) & (df_test[\"Profession\"].notna())]\n","print(\"Number of students who have a profession:\", len(students_with_profession))\n"]},{"cell_type":"code","execution_count":23,"id":"e4387c7f","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:42.509901Z","iopub.status.busy":"2025-11-13T18:49:42.509288Z","iopub.status.idle":"2025-11-13T18:49:42.529041Z","shell.execute_reply":"2025-11-13T18:49:42.528064Z"},"papermill":{"duration":0.03034,"end_time":"2025-11-13T18:49:42.530709","exception":false,"start_time":"2025-11-13T18:49:42.500369","status":"completed"},"tags":[]},"outputs":[],"source":["for df in [df_train, df_test]:\n","    mask = (df[\"Employment\"] == 0) & (df[\"Profession\"].notna())\n","    df.loc[mask, \"Profession\"] = np.nan"]},{"cell_type":"code","execution_count":24,"id":"37e6f753","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:42.549921Z","iopub.status.busy":"2025-11-13T18:49:42.549372Z","iopub.status.idle":"2025-11-13T18:49:42.571399Z","shell.execute_reply":"2025-11-13T18:49:42.570629Z"},"papermill":{"duration":0.032367,"end_time":"2025-11-13T18:49:42.572522","exception":false,"start_time":"2025-11-13T18:49:42.540155","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Jobs count\n","Teacher: 0\n","Content Writer: 1\n","Architect: 2\n","Consultant: 3\n","Pharmacist: 4\n","HR Manager: 5\n","Doctor: 6\n","Business Analyst: 7\n","Chemist: 8\n","Entrepreneur: 9\n","Chef: 10\n","Educational Consultant: 11\n","Data Scientist: 12\n","Lawyer: 13\n","Researcher: 14\n","Pilot: 15\n","Customer Support: 16\n","Marketing Manager: 17\n","Judge: 18\n","Travel Consultant: 19\n","Manager: 20\n","Sales Executive: 21\n","Plumber: 22\n","Electrician: 23\n","Financial Analyst: 24\n","Software Engineer: 25\n","Digital Marketer: 26\n","Civil Engineer: 27\n","UX/UI Designer: 28\n","Finanancial Analyst: 29\n","Accountant: 30\n","Mechanical Engineer: 31\n","Graphic Designer: 32\n","Research Analyst: 33\n","Investment Banker: 34\n"]}],"source":["# i label encode this for 2 dataset for reason \n","# in missing handling part you will see\n","professions = [\n","    \"Teacher\", \"Content Writer\", \"Architect\", \"Consultant\", \"Pharmacist\", \"HR Manager\",\n","    \"Doctor\", \"Business Analyst\", \"Chemist\", \"Entrepreneur\", \"Chef\", \"Educational Consultant\",\n","    \"Data Scientist\", \"Lawyer\", \"Researcher\", \"Pilot\", \"Customer Support\", \"Marketing Manager\",\n","    \"Judge\", \"Travel Consultant\", \"Manager\", \"Sales Executive\", \"Plumber\", \"Electrician\",\n","    \"Financial Analyst\", \"Software Engineer\", \"Digital Marketer\", \"Civil Engineer\",\n","    \"UX/UI Designer\", \"Finanancial Analyst\", \"Accountant\", \"Mechanical Engineer\",\n","    \"Graphic Designer\", \"Research Analyst\", \"Investment Banker\"\n","]\n","\n","profession_mapping = {profession: idx for idx, profession in enumerate(professions)}\n","\n","for df in [df_train, df_test]:\n","    df[\"Profession\"] = df[\"Profession\"].map(profession_mapping)\n","print(\"Jobs count\")\n","for job, code in profession_mapping.items():\n","    print(f\"{job}: {code}\")"]},{"cell_type":"code","execution_count":25,"id":"5212ce81","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:42.592117Z","iopub.status.busy":"2025-11-13T18:49:42.591608Z","iopub.status.idle":"2025-11-13T18:49:42.629281Z","shell.execute_reply":"2025-11-13T18:49:42.628503Z"},"papermill":{"duration":0.048776,"end_time":"2025-11-13T18:49:42.630738","exception":false,"start_time":"2025-11-13T18:49:42.581962","status":"completed"},"tags":[]},"outputs":[],"source":["for df in [df_train, df_test]:\n","    df[\"Profession\"] = df[\"Profession\"].astype(\"object\")\n","\n","    df.loc[(df[\"Employment\"] == 0) & (df[\"Profession\"].isna()), \"Profession\"] = 35\n","\n","    df.loc[df[\"Employment\"] == 1, [\"Academic Pressure\", \"Study Satisfaction\"]] = 0 \n","\n","    df.loc[df[\"Employment\"] == 0, [\"Work Pressure\", \"Job Satisfaction\"]] = 0"]},{"cell_type":"code","execution_count":26,"id":"6075408a","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:42.650414Z","iopub.status.busy":"2025-11-13T18:49:42.649968Z","iopub.status.idle":"2025-11-13T18:49:42.675918Z","shell.execute_reply":"2025-11-13T18:49:42.675121Z"},"papermill":{"duration":0.036958,"end_time":"2025-11-13T18:49:42.677224","exception":false,"start_time":"2025-11-13T18:49:42.640266","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Checking for missing values in each column:\n","Gender                   0\n","Age                      0\n","City                    98\n","Employment               0\n","Profession            8810\n","Academic Pressure        9\n","Work Pressure           20\n","CGPA                     0\n","Study Satisfaction      10\n","Job Satisfaction        17\n","Sleep Duration          79\n","Dietary Habits          27\n","Degree                 116\n","Suicidal thoughts        0\n","WS hours                 0\n","Financial Stress         4\n","Family illness           0\n","Depression               0\n","dtype: int64\n"]}],"source":["print(\"Checking for missing values in each column:\")\n","print(df_train.isnull().sum())"]},{"cell_type":"code","execution_count":27,"id":"cfb3b04e","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:42.696392Z","iopub.status.busy":"2025-11-13T18:49:42.695842Z","iopub.status.idle":"2025-11-13T18:49:42.712284Z","shell.execute_reply":"2025-11-13T18:49:42.711347Z"},"papermill":{"duration":0.027696,"end_time":"2025-11-13T18:49:42.714191","exception":false,"start_time":"2025-11-13T18:49:42.686495","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Checking for missing values in each column:\n","Gender                   0\n","Age                      0\n","City                    20\n","Employment               0\n","Profession            5926\n","Academic Pressure        7\n","Work Pressure           10\n","CGPA                     0\n","Study Satisfaction       8\n","Job Satisfaction         9\n","Sleep Duration          54\n","Dietary Habits          30\n","Degree                  86\n","Suicidal thoughts        0\n","WS hours                 0\n","Financial Stress         0\n","Family illness           0\n","dtype: int64\n"]}],"source":["print(\"Checking for missing values in each column:\")\n","print(df_test.isnull().sum())"]},{"cell_type":"markdown","id":"6fac5ba0","metadata":{"papermill":{"duration":0.016307,"end_time":"2025-11-13T18:49:42.746373","exception":false,"start_time":"2025-11-13T18:49:42.730066","status":"completed"},"tags":[]},"source":["* People who have job but they didnt enter their profession in train dataset"]},{"cell_type":"code","execution_count":28,"id":"06204076","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:42.771399Z","iopub.status.busy":"2025-11-13T18:49:42.77092Z","iopub.status.idle":"2025-11-13T18:49:42.789236Z","shell.execute_reply":"2025-11-13T18:49:42.788529Z"},"papermill":{"duration":0.030047,"end_time":"2025-11-13T18:49:42.790322","exception":false,"start_time":"2025-11-13T18:49:42.760275","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["Employment\n","1             8810\n","Name: count, dtype: int64"]},"execution_count":28,"metadata":{},"output_type":"execute_result"}],"source":["df_train.loc[df_train[\"Profession\"].isna(), [\"Employment\"]].value_counts()"]},{"cell_type":"markdown","id":"da7af4c2","metadata":{"papermill":{"duration":0.008824,"end_time":"2025-11-13T18:49:42.808284","exception":false,"start_time":"2025-11-13T18:49:42.79946","status":"completed"},"tags":[]},"source":["* People who have job but they didnt enter their profession in test dataset"]},{"cell_type":"code","execution_count":29,"id":"2efe8289","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:42.826893Z","iopub.status.busy":"2025-11-13T18:49:42.826579Z","iopub.status.idle":"2025-11-13T18:49:42.837316Z","shell.execute_reply":"2025-11-13T18:49:42.836728Z"},"papermill":{"duration":0.021448,"end_time":"2025-11-13T18:49:42.838439","exception":false,"start_time":"2025-11-13T18:49:42.816991","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["Employment\n","1             5926\n","Name: count, dtype: int64"]},"execution_count":29,"metadata":{},"output_type":"execute_result"}],"source":["df_test.loc[df_test[\"Profession\"].isna(), [\"Employment\"]].value_counts()"]},{"cell_type":"code","execution_count":30,"id":"e9cc4c40","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:42.857357Z","iopub.status.busy":"2025-11-13T18:49:42.85718Z","iopub.status.idle":"2025-11-13T18:49:42.921888Z","shell.execute_reply":"2025-11-13T18:49:42.921332Z"},"papermill":{"duration":0.075422,"end_time":"2025-11-13T18:49:42.923014","exception":false,"start_time":"2025-11-13T18:49:42.847592","status":"completed"},"tags":[]},"outputs":[],"source":["np.random.seed(369)\n","random.seed(369)\n","\n","for df in [df_train, df_test]:\n","    df[\"Profession\"] = df[\"Profession\"].astype(\"Int16\")\n","\n","    probabilities = df.loc[(df['Profession'].notna()) & (df['Profession'] != 35), 'Profession'].value_counts(normalize=True)\n","\n","    missing_idx = df[df['Profession'].isna()].index\n","\n","    df.loc[missing_idx, 'Profession'] = np.random.choice(\n","        probabilities.index, size=len(missing_idx), p=probabilities.values\n","    )\n","\n","    df[\"Profession\"] = df[\"Profession\"].astype(\"Int16\")"]},{"cell_type":"code","execution_count":31,"id":"7995ced7","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:42.942287Z","iopub.status.busy":"2025-11-13T18:49:42.942115Z","iopub.status.idle":"2025-11-13T18:49:42.967467Z","shell.execute_reply":"2025-11-13T18:49:42.96659Z"},"papermill":{"duration":0.036165,"end_time":"2025-11-13T18:49:42.968626","exception":false,"start_time":"2025-11-13T18:49:42.932461","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Checking for missing values in each column:\n","Gender                  0\n","Age                     0\n","City                   98\n","Employment              0\n","Profession              0\n","Academic Pressure       9\n","Work Pressure          20\n","CGPA                    0\n","Study Satisfaction     10\n","Job Satisfaction       17\n","Sleep Duration         79\n","Dietary Habits         27\n","Degree                116\n","Suicidal thoughts       0\n","WS hours                0\n","Financial Stress        4\n","Family illness          0\n","Depression              0\n","dtype: int64\n","Gender                 0\n","Age                    0\n","City                  20\n","Employment             0\n","Profession             0\n","Academic Pressure      7\n","Work Pressure         10\n","CGPA                   0\n","Study Satisfaction     8\n","Job Satisfaction       9\n","Sleep Duration        54\n","Dietary Habits        30\n","Degree                86\n","Suicidal thoughts      0\n","WS hours               0\n","Financial Stress       0\n","Family illness         0\n","dtype: int64\n"]}],"source":["print(\"Checking for missing values in each column:\")\n","print(df_train.isnull().sum())\n","print(df_test.isnull().sum())"]},{"cell_type":"code","execution_count":32,"id":"dcae5146","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:42.987344Z","iopub.status.busy":"2025-11-13T18:49:42.987141Z","iopub.status.idle":"2025-11-13T18:49:43.034288Z","shell.execute_reply":"2025-11-13T18:49:43.033786Z"},"papermill":{"duration":0.057759,"end_time":"2025-11-13T18:49:43.035366","exception":false,"start_time":"2025-11-13T18:49:42.977607","status":"completed"},"tags":[]},"outputs":[],"source":["columns_to_fill = [\n","    \"City\", \n","    \"Work Pressure\", \n","    \"Study Satisfaction\", \n","    \"Job Satisfaction\", \n","    \"Sleep Duration\", \n","    \"Dietary Habits\", \n","    \"Degree\",\n","    \"Financial Stress\",\n","    \"Academic Pressure\"\n","]\n","\n","for df in [df_train, df_test]:\n","    for col in columns_to_fill:\n","        if col in df.columns:\n","            mode_val = df[col].mode(dropna=True)\n","            if not mode_val.empty:\n","                df[col].fillna(mode_val[0], inplace=True)"]},{"cell_type":"code","execution_count":33,"id":"e06b147c","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:43.055521Z","iopub.status.busy":"2025-11-13T18:49:43.055305Z","iopub.status.idle":"2025-11-13T18:49:43.081549Z","shell.execute_reply":"2025-11-13T18:49:43.080974Z"},"papermill":{"duration":0.038228,"end_time":"2025-11-13T18:49:43.082606","exception":false,"start_time":"2025-11-13T18:49:43.044378","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Checking for missing values in each column:\n","Gender                0\n","Age                   0\n","City                  0\n","Employment            0\n","Profession            0\n","Academic Pressure     0\n","Work Pressure         0\n","CGPA                  0\n","Study Satisfaction    0\n","Job Satisfaction      0\n","Sleep Duration        0\n","Dietary Habits        0\n","Degree                0\n","Suicidal thoughts     0\n","WS hours              0\n","Financial Stress      0\n","Family illness        0\n","Depression            0\n","dtype: int64\n","Gender                0\n","Age                   0\n","City                  0\n","Employment            0\n","Profession            0\n","Academic Pressure     0\n","Work Pressure         0\n","CGPA                  0\n","Study Satisfaction    0\n","Job Satisfaction      0\n","Sleep Duration        0\n","Dietary Habits        0\n","Degree                0\n","Suicidal thoughts     0\n","WS hours              0\n","Financial Stress      0\n","Family illness        0\n","dtype: int64\n"]}],"source":["print(\"Checking for missing values in each column:\")\n","print(df_train.isnull().sum())\n","print(df_test.isnull().sum())"]},{"cell_type":"markdown","id":"b536db18","metadata":{"papermill":{"duration":0.009073,"end_time":"2025-11-13T18:49:43.100582","exception":false,"start_time":"2025-11-13T18:49:43.091509","status":"completed"},"tags":[]},"source":["## Pair plot before modeling"]},{"cell_type":"code","execution_count":34,"id":"0c1d45ae","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:43.119575Z","iopub.status.busy":"2025-11-13T18:49:43.119012Z","iopub.status.idle":"2025-11-13T18:49:43.131423Z","shell.execute_reply":"2025-11-13T18:49:43.130659Z"},"papermill":{"duration":0.023064,"end_time":"2025-11-13T18:49:43.13249","exception":false,"start_time":"2025-11-13T18:49:43.109426","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Gender</th>\n","      <th>Age</th>\n","      <th>City</th>\n","      <th>Employment</th>\n","      <th>Profession</th>\n","      <th>Academic Pressure</th>\n","      <th>Work Pressure</th>\n","      <th>CGPA</th>\n","      <th>Study Satisfaction</th>\n","      <th>Job Satisfaction</th>\n","      <th>Sleep Duration</th>\n","      <th>Dietary Habits</th>\n","      <th>Degree</th>\n","      <th>Suicidal thoughts</th>\n","      <th>WS hours</th>\n","      <th>Financial Stress</th>\n","      <th>Family illness</th>\n","      <th>Depression</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>49</td>\n","      <td>Ludhiana</td>\n","      <td>1</td>\n","      <td>10</td>\n","      <td>0</td>\n","      <td>5</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>2</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>2</td>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>26</td>\n","      <td>Varanasi</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>4</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>3</td>\n","      <td>4</td>\n","      <td>3</td>\n","      <td>4</td>\n","      <td>1</td>\n","      <td>4</td>\n","      <td>3</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>33</td>\n","      <td>Visakhapatnam</td>\n","      <td>0</td>\n","      <td>35</td>\n","      <td>5</td>\n","      <td>0</td>\n","      <td>4</td>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>3</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>22</td>\n","      <td>Mumbai</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>5</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>4</td>\n","      <td>2</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>1</td>\n","      <td>30</td>\n","      <td>Kanpur</td>\n","      <td>1</td>\n","      <td>7</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>3</td>\n","      <td>3</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>4</td>\n","      <td>4</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["   Gender  Age           City  Employment  Profession  Academic Pressure  \\\n","0       1   49       Ludhiana           1          10                  0   \n","1       0   26       Varanasi           1           0                  0   \n","2       0   33  Visakhapatnam           0          35                  5   \n","3       0   22         Mumbai           1           0                  0   \n","4       1   30         Kanpur           1           7                  0   \n","\n","   Work Pressure  CGPA  Study Satisfaction  Job Satisfaction  Sleep Duration  \\\n","0              5     0                   0                 2               2   \n","1              4     0                   0                 3               4   \n","2              0     4                   2                 0               3   \n","3              5     0                   0                 1               4   \n","4              1     0                   0                 1               3   \n","\n","   Dietary Habits  Degree  Suicidal thoughts  WS hours  Financial Stress  \\\n","0               1       2                  0         2                 2   \n","1               3       4                  1         4                 3   \n","2               1       2                  1         2                 1   \n","3               2       2                  1         5                 1   \n","4               3       2                  1         4                 4   \n","\n","   Family illness Depression  \n","0               0          0  \n","1               0          1  \n","2               0          1  \n","3               1          1  \n","4               1          0  "]},"execution_count":34,"metadata":{},"output_type":"execute_result"}],"source":["df_train.head()"]},{"cell_type":"code","execution_count":35,"id":"dfea7882","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:43.151601Z","iopub.status.busy":"2025-11-13T18:49:43.151408Z","iopub.status.idle":"2025-11-13T18:49:43.154429Z","shell.execute_reply":"2025-11-13T18:49:43.153752Z"},"papermill":{"duration":0.013915,"end_time":"2025-11-13T18:49:43.155536","exception":false,"start_time":"2025-11-13T18:49:43.141621","status":"completed"},"tags":[]},"outputs":[],"source":["# df_train.drop([\"City\"], axis = 1, inplace = True)"]},{"cell_type":"code","execution_count":36,"id":"88645b9a","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:43.17468Z","iopub.status.busy":"2025-11-13T18:49:43.174472Z","iopub.status.idle":"2025-11-13T18:49:43.177518Z","shell.execute_reply":"2025-11-13T18:49:43.176805Z"},"papermill":{"duration":0.01403,"end_time":"2025-11-13T18:49:43.178634","exception":false,"start_time":"2025-11-13T18:49:43.164604","status":"completed"},"tags":[]},"outputs":[],"source":["# plt.figure(figsize = (12,10), dpi = 80)\n","\n","# corr = df_train.corr()\n","\n","# sns.heatmap(corr, cmap = \"coolwarm\",\n","#            annot = True, fmt=\".2f\")\n","\n","# plt.title(\"Correlogram of patient\", fontsize = 22)\n","# plt.xticks(fontsize = 12)\n","# plt.yticks(fontsize = 12)\n","# plt.show()"]},{"cell_type":"markdown","id":"ddfa6745","metadata":{"papermill":{"duration":0.009024,"end_time":"2025-11-13T18:49:43.196549","exception":false,"start_time":"2025-11-13T18:49:43.187525","status":"completed"},"tags":[]},"source":["## Encoding"]},{"cell_type":"code","execution_count":37,"id":"934bebd8","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:43.215624Z","iopub.status.busy":"2025-11-13T18:49:43.215119Z","iopub.status.idle":"2025-11-13T18:49:43.439857Z","shell.execute_reply":"2025-11-13T18:49:43.439231Z"},"papermill":{"duration":0.235616,"end_time":"2025-11-13T18:49:43.441169","exception":false,"start_time":"2025-11-13T18:49:43.205553","status":"completed"},"tags":[]},"outputs":[],"source":["encoder = TargetEncoder(cols=['City', 'Profession'])\n","\n","y_train = df_train['Depression'].astype(float)\n","\n","df_train[['City_encoded', 'Profession_encoded']] = encoder.fit_transform(\n","    df_train[['City', 'Profession']], \n","    y_train\n",")[['City', 'Profession']]\n","\n","df_test[['City_encoded', 'Profession_encoded']] = encoder.transform(\n","    df_test[['City', 'Profession']]\n",")[['City', 'Profession']]\n","\n","df_train = df_train.drop(['City', 'Profession'], axis=1)\n","df_test = df_test.drop(['City', 'Profession'], axis=1)"]},{"cell_type":"markdown","id":"2e26f16b","metadata":{"papermill":{"duration":0.009466,"end_time":"2025-11-13T18:49:43.460385","exception":false,"start_time":"2025-11-13T18:49:43.450919","status":"completed"},"tags":[]},"source":["## Train Test"]},{"cell_type":"code","execution_count":38,"id":"a69fc207","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:43.47988Z","iopub.status.busy":"2025-11-13T18:49:43.479618Z","iopub.status.idle":"2025-11-13T18:49:43.496198Z","shell.execute_reply":"2025-11-13T18:49:43.495605Z"},"papermill":{"duration":0.027782,"end_time":"2025-11-13T18:49:43.497424","exception":false,"start_time":"2025-11-13T18:49:43.469642","status":"completed"},"tags":[]},"outputs":[],"source":["X_train = df_train.drop('Depression', axis=1)\n","y_train = df_train['Depression']\n","X_test = df_test.copy()"]},{"cell_type":"code","execution_count":39,"id":"2fd8c142","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:43.517402Z","iopub.status.busy":"2025-11-13T18:49:43.516825Z","iopub.status.idle":"2025-11-13T18:49:43.53468Z","shell.execute_reply":"2025-11-13T18:49:43.534148Z"},"papermill":{"duration":0.029051,"end_time":"2025-11-13T18:49:43.535783","exception":false,"start_time":"2025-11-13T18:49:43.506732","status":"completed"},"tags":[]},"outputs":[],"source":["numerical_columns = X_train.select_dtypes(include=['float64', 'int64', 'int16']).columns.tolist()"]},{"cell_type":"code","execution_count":40,"id":"792e0105","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:43.555059Z","iopub.status.busy":"2025-11-13T18:49:43.554834Z","iopub.status.idle":"2025-11-13T18:49:43.559429Z","shell.execute_reply":"2025-11-13T18:49:43.558711Z"},"papermill":{"duration":0.015392,"end_time":"2025-11-13T18:49:43.560527","exception":false,"start_time":"2025-11-13T18:49:43.545135","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["['Gender',\n"," 'Age',\n"," 'Employment',\n"," 'Academic Pressure',\n"," 'Work Pressure',\n"," 'CGPA',\n"," 'Study Satisfaction',\n"," 'Job Satisfaction',\n"," 'Sleep Duration',\n"," 'Dietary Habits',\n"," 'Degree',\n"," 'Suicidal thoughts',\n"," 'WS hours',\n"," 'Financial Stress',\n"," 'Family illness',\n"," 'City_encoded',\n"," 'Profession_encoded']"]},"execution_count":40,"metadata":{},"output_type":"execute_result"}],"source":["numerical_columns"]},{"cell_type":"code","execution_count":41,"id":"58fffb98","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:43.581864Z","iopub.status.busy":"2025-11-13T18:49:43.581645Z","iopub.status.idle":"2025-11-13T18:49:43.736547Z","shell.execute_reply":"2025-11-13T18:49:43.735803Z"},"papermill":{"duration":0.167313,"end_time":"2025-11-13T18:49:43.738301","exception":false,"start_time":"2025-11-13T18:49:43.570988","status":"completed"},"tags":[]},"outputs":[],"source":["binary_cols = ['Gender', 'Employment', 'Suicidal thoughts', 'Family illness']\n","\n","scale_cols = [c for c in X_train.columns if c not in binary_cols]\n","\n","scaler = StandardScaler()\n","X_train[scale_cols] = scaler.fit_transform(X_train[scale_cols])\n","X_test[scale_cols] = scaler.transform(X_test[scale_cols])"]},{"cell_type":"markdown","id":"6863bd8e","metadata":{"papermill":{"duration":0.009067,"end_time":"2025-11-13T18:49:43.757488","exception":false,"start_time":"2025-11-13T18:49:43.748421","status":"completed"},"tags":[]},"source":["# Modeling"]},{"cell_type":"markdown","id":"64268a88","metadata":{"papermill":{"duration":0.009773,"end_time":"2025-11-13T18:49:43.776224","exception":false,"start_time":"2025-11-13T18:49:43.766451","status":"completed"},"tags":[]},"source":["## Ensemble"]},{"cell_type":"code","execution_count":42,"id":"8ac60b9f","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:49:43.795994Z","iopub.status.busy":"2025-11-13T18:49:43.795735Z","iopub.status.idle":"2025-11-13T18:52:25.358742Z","shell.execute_reply":"2025-11-13T18:52:25.358007Z"},"papermill":{"duration":161.58474,"end_time":"2025-11-13T18:52:25.370537","exception":false,"start_time":"2025-11-13T18:49:43.785797","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Cross-Validation Scores: [0.93848614 0.94051173 0.93837953 0.93948117 0.94171997]\n","Mean CV Accuracy: 0.9397\n","Standard Deviation of CV Accuracy: 0.0013\n"]},{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>class</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>140700</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>140701</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>140702</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>140703</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>140704</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["       id class\n","0  140700     0\n","1  140701     0\n","2  140702     0\n","3  140703     1\n","4  140704     0"]},"execution_count":42,"metadata":{},"output_type":"execute_result"}],"source":["xgb_params = {\n","     'learning_rate': 0.298913248058474, \n","     'max_depth': 9, \n","     'min_child_weight': 3, \n","     'n_estimators': 673, \n","     'subsample': 0.5933970249700855, \n","     'gamma': 2.597137534750985, \n","     'reg_lambda': 0.11328048420927406, \n","     'colsample_bytree': 0.1381203919800721\n","}\n","\n","catboost_params = {\n","    'iterations': 145, \n","    'depth': 7, \n","    'learning_rate': 0.29930179265937246, \n","    'l2_leaf_reg': 1.242352421942431, \n","    'random_strength': 8.325681754379957, \n","    'bagging_temperature': 0.7869848919618048, \n","    'border_count': 139\n","}\n","\n","hgb_params = {\n","    'learning_rate': 0.16299202834206894, \n","    'max_iter': 250, \n","    'max_depth': 4, \n","    'l2_regularization': 7.1826466833939895,\n","    'early_stopping': True\n","}\n","\n","xgb_model = XGBClassifier(**xgb_params, use_label_encoder=False, random_state=369)\n","catboost_model = CatBoostClassifier(**catboost_params, task_type=\"GPU\", random_state=369, verbose=0)\n","hgb_model = HistGradientBoostingClassifier(**hgb_params, random_state=369)\n","\n","stacking_ensemble = StackingClassifier(\n","    estimators=[\n","        ('catboost', catboost_model),\n","        ('xgb', xgb_model),\n","        ('hgb', hgb_model)\n","    ],\n","    final_estimator=LogisticRegression(),\n","    passthrough=False\n",")\n","\n","scoring = make_scorer(accuracy_score)\n","\n","cv_scores = cross_val_score(stacking_ensemble, X_train, y_train, cv=5, scoring=scoring)\n","\n","print(f\"Cross-Validation Scores: {cv_scores}\")\n","print(f\"Mean CV Accuracy: {cv_scores.mean():.4f}\")\n","print(f\"Standard Deviation of CV Accuracy: {cv_scores.std():.4f}\")\n","\n","stacking_ensemble.fit(X_train, y_train)\n","\n","y_hat_test = stacking_ensemble.predict(X_test)\n","\n","submission = pd.DataFrame({'id': test_ids,\n","                       'class': y_hat_test})\n","\n","submission.to_csv('/kaggle/working/submission.csv', index=False)\n","\n","submission.head()"]},{"cell_type":"markdown","id":"80ff9174","metadata":{"papermill":{"duration":0.009481,"end_time":"2025-11-13T18:52:25.390585","exception":false,"start_time":"2025-11-13T18:52:25.381104","status":"completed"},"tags":[]},"source":["## Random Forest"]},{"cell_type":"code","execution_count":43,"id":"0755d42a","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:52:25.410793Z","iopub.status.busy":"2025-11-13T18:52:25.410542Z","iopub.status.idle":"2025-11-13T18:52:25.414064Z","shell.execute_reply":"2025-11-13T18:52:25.413482Z"},"papermill":{"duration":0.014844,"end_time":"2025-11-13T18:52:25.415247","exception":false,"start_time":"2025-11-13T18:52:25.400403","status":"completed"},"tags":[]},"outputs":[],"source":["# from sklearn.ensemble import RandomForestClassifier\n","# from sklearn.model_selection import GridSearchCV\n","# import pandas as pd\n","\n","# RF_model = RandomForestClassifier(\n","#     random_state=369,\n","#     class_weight='balanced'\n","# )\n","\n","# param_grid_rf = {\n","#     'n_estimators': [500],\n","#     'criterion': ['entropy'],\n","#     'max_depth': [9],\n","#     'min_samples_split': [6],\n","#     'min_samples_leaf': [5],\n","#     'max_features': [None],\n","#     'max_leaf_nodes': [80]\n","# }\n","\n","# grid_search_rf = GridSearchCV(\n","#     estimator=RF_model,\n","#     param_grid=param_grid_rf,\n","#     cv=5,\n","#     scoring='accuracy',\n","#     n_jobs=-1,\n","#     verbose=1\n","# )\n","\n","# grid_search_rf.fit(X_train, y_train)\n","\n","# y_hat_test = grid_search_rf.predict(X_test)\n","\n","# submission = pd.DataFrame({\n","#     'id': test_ids,\n","#     'class': y_hat_test\n","# })\n","\n","# submission.to_csv('submission4.csv', index=False)\n","# print(submission.head())"]},{"cell_type":"markdown","id":"947e9367","metadata":{"papermill":{"duration":0.009219,"end_time":"2025-11-13T18:52:25.433778","exception":false,"start_time":"2025-11-13T18:52:25.424559","status":"completed"},"tags":[]},"source":["## Solo XGB"]},{"cell_type":"code","execution_count":44,"id":"a16539ea","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:52:25.453627Z","iopub.status.busy":"2025-11-13T18:52:25.453424Z","iopub.status.idle":"2025-11-13T18:52:30.393233Z","shell.execute_reply":"2025-11-13T18:52:30.392258Z"},"papermill":{"duration":4.95141,"end_time":"2025-11-13T18:52:30.394729","exception":false,"start_time":"2025-11-13T18:52:25.443319","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["       id  class\n","0  140700      0\n","1  140701      0\n","2  140702      0\n","3  140703      1\n","4  140704      0\n"]}],"source":["y_train = y_train.astype(int)\n","\n","xgb_model = XGBClassifier(\n","    n_jobs = 1,\n","    objective = 'binary:logistic',\n","    eval_metric = 'logloss',\n","    random_state = 369, \n","    reg_lambda = 1.0,\n","    reg_alpha = 0.2,\n","    max_depth = 3,\n","    min_child_weight = 7,\n","    subsample = 0.8,\n","    colsample_bytree = 0.8,\n","    learning_rate = 0.05,\n","    n_estimators = 500\n",")\n","\n","xgb_model.fit(X_train, y_train, verbose = False)\n","\n","y_hat_test = xgb_model.predict(X_test)\n","\n","submission = pd.DataFrame({\n","    'id': test_ids,\n","    'class': y_hat_test\n","})\n","\n","submission.to_csv('submission2.csv', index=False)\n","print(submission.head())"]},{"cell_type":"markdown","id":"09ff00a8","metadata":{"papermill":{"duration":0.010052,"end_time":"2025-11-13T18:52:30.416219","exception":false,"start_time":"2025-11-13T18:52:30.406167","status":"completed"},"tags":[]},"source":["## Logistic Regression"]},{"cell_type":"code","execution_count":45,"id":"9f45e281","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:52:30.437195Z","iopub.status.busy":"2025-11-13T18:52:30.436556Z","iopub.status.idle":"2025-11-13T18:52:30.440597Z","shell.execute_reply":"2025-11-13T18:52:30.439811Z"},"papermill":{"duration":0.015973,"end_time":"2025-11-13T18:52:30.441871","exception":false,"start_time":"2025-11-13T18:52:30.425898","status":"completed"},"tags":[]},"outputs":[],"source":["# logreg = LogisticRegression(max_iter = 500, random_state = 369, class_weight = 'balanced')\n","\n","# param_grid = {\n","#     'C': [500, 100],\n","#     'penalty': ['elasticnet'],\n","#     'solver': ['saga'],\n","#     'l1_ratio': [1.0]\n","# }\n","\n","# grid_logreg = GridSearchCV(\n","#     estimator = logreg,\n","#     param_grid = param_grid,\n","#     cv = 5,\n","#     scoring = 'accuracy',\n","#     n_jobs = -1,\n","#     verbose = 1\n","# )\n","\n","# grid_logreg.fit(X_train, y_train)\n","\n","# print(\"Best Parameters:\", grid_logreg.best_params_)\n","# print(\"Best CV Score:\", grid_logreg.best_score_)\n","\n","# y_hat_test = grid_logreg.predict(X_test)\n","\n","# submission = pd.DataFrame({\n","#     'id': test_ids,\n","#     'class': y_hat_test\n","# })\n","\n","# submission.to_csv('submission6.csv', index=False)\n","# print(submission.head())"]},{"cell_type":"markdown","id":"55d35955","metadata":{"papermill":{"duration":0.011019,"end_time":"2025-11-13T18:52:30.463876","exception":false,"start_time":"2025-11-13T18:52:30.452857","status":"completed"},"tags":[]},"source":["## SVM"]},{"cell_type":"code","execution_count":46,"id":"c69b1f4b","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:52:30.487014Z","iopub.status.busy":"2025-11-13T18:52:30.486494Z","iopub.status.idle":"2025-11-13T18:52:30.489917Z","shell.execute_reply":"2025-11-13T18:52:30.489314Z"},"papermill":{"duration":0.016078,"end_time":"2025-11-13T18:52:30.491018","exception":false,"start_time":"2025-11-13T18:52:30.47494","status":"completed"},"tags":[]},"outputs":[],"source":["# svm = SVC(probability = True, random_state = 369, class_weight = 'balanced')\n","\n","# param_grid_svm = {\n","#     'kernel': ['linear'],\n","#     'C': [10],\n","#     'gamma': ['scale']                \n","# }\n","\n","# grid_search_svm = GridSearchCV(\n","#     estimator = svm,\n","#     param_grid = param_grid_svm,\n","#     cv = 10,\n","#     scoring = 'accuracy',\n","#     n_jobs = -1,\n","#     verbose = 1\n","# )\n","\n","# grid_search_svm.fit(X_train, y_train)\n","\n","# print(\"Best Parameters:\", grid_search_svm.best_params_)\n","# print(\"Best CV Score:\", grid_search_svm.best_score_)\n","\n","# y_hat_test = grid_search_svm.predict(X_test)\n","\n","# submission = pd.DataFrame({\n","#     'id': test_ids,\n","#     'class': y_hat_test\n","# })\n","\n","# submission.to_csv('submission7.csv', index=False)\n","# print(submission.head())"]},{"cell_type":"markdown","id":"73e56014","metadata":{"papermill":{"duration":0.011111,"end_time":"2025-11-13T18:52:30.512967","exception":false,"start_time":"2025-11-13T18:52:30.501856","status":"completed"},"tags":[]},"source":["## MLP"]},{"cell_type":"code","execution_count":47,"id":"be19548c","metadata":{"execution":{"iopub.execute_input":"2025-11-13T18:52:30.535071Z","iopub.status.busy":"2025-11-13T18:52:30.534568Z","iopub.status.idle":"2025-11-13T18:52:30.538168Z","shell.execute_reply":"2025-11-13T18:52:30.537508Z"},"papermill":{"duration":0.014931,"end_time":"2025-11-13T18:52:30.539178","exception":false,"start_time":"2025-11-13T18:52:30.524247","status":"completed"},"tags":[]},"outputs":[],"source":["# mlp = MLPClassifier(\n","#     max_iter = 300, \n","#     early_stopping = True, \n","#     random_state = 369\n","#     )\n","\n","# param_grid_mlp = {\n","#     'hidden_layer_sizes': [(32, 16)],\n","#     'activation': ['relu'],\n","#     'solver': ['adam'],\n","#     'alpha': [0.01],\n","#     'learning_rate': ['constant'],\n","#     'learning_rate_init': [0.001],\n","#     'tol': [1e-3],\n","#     'batch_size': [32]\n","# }\n","\n","# grid_search_mlp = GridSearchCV(\n","#     estimator = mlp,\n","#     param_grid = param_grid_mlp,\n","#     cv = 10,\n","#     scoring = 'accuracy',\n","#     n_jobs = -1,\n","#     verbose = 1\n","# )\n","\n","# grid_search_mlp.fit(X_train, y_train)\n","\n","# print(\"Best Parameters:\", grid_search_mlp.best_params_)\n","# print(\"Best CV Score:\", grid_search_mlp.best_score_)\n","\n","# y_hat_test = grid_search_mlp.predict(X_test)\n","\n","# submission = pd.DataFrame({\n","#     'id': test_ids,\n","#     'class': y_hat_test\n","# })\n","\n","# submission.to_csv('submission8.csv', index=False)\n","# print(submission.head())"]}],"metadata":{"kaggle":{"accelerator":"nvidiaTeslaT4","dataSources":[{"databundleVersionId":10008389,"sourceId":84895,"sourceType":"competition"}],"dockerImageVersionId":31192,"isGpuEnabled":true,"isInternetEnabled":true,"language":"python","sourceType":"notebook"},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.11.13"},"papermill":{"default_parameters":{},"duration":182.794204,"end_time":"2025-11-13T18:52:31.166189","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2025-11-13T18:49:28.371985","version":"2.6.0"}},"nbformat":4,"nbformat_minor":5}